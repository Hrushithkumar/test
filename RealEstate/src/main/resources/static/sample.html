<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Iron Pillar Engineering and Construction</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Add your CSS styling here */
      body {
        font-family: "Montserrat", sans-serif;
        background-color: #f4f7f6;
        color: #333;
        line-height: 1.6;
        margin: 0;
        padding-top: 80px;
      }
      header {
        background-color: #2c3e50;
        padding: 10px 20px;
        position: fixed;
        width: 100%;
        top: 0;
        z-index: 1000;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      header .logo {
        display: flex;
        align-items: center;
        color: #fff;
        font-size: 1.5em;
        font-weight: bold;
      }
      header .logo img {
        max-width: 50px;
        height: auto;
        margin-right: 10px;
      }
      header nav ul {
        list-style: none;
        display: flex;
        margin: 0;
        padding: 0;
      }
      header nav ul li {
        margin: 0 15px;
      }
      header nav ul li a {
        color: #fff;
        text-decoration: none;
        font-weight: bold;
        font-size: 1em;
        transition: color 0.3s;
      }
      header nav ul li a:hover {
        color: #f39c12;
      }
      .hero {
        background: url("https://via.placeholder.com/1200x400") no-repeat center
          center/cover;
        color: white;
        height: 400px;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        text-align: center;
        border-bottom: 10px solid #2c3e50;
        padding: 20px;
      }
      .hero .hero-content {
        background-color: rgba(44, 62, 80, 0.8);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        transform: perspective(500px) rotateX(10deg) translateZ(50px);
      }
      .hero h1 {
        font-size: 3.5em;
        margin-bottom: 15px;
        text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.3);
      }
      .hero p {
        font-size: 1.3em;
        margin-bottom: 15px;
        text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.3);
      }
      .about {
        padding: 40px 0;
        text-align: center;
      }
      .about h2 {
        font-size: 2.2em;
        margin-bottom: 20px;
      }
      .about p {
        font-size: 1.1em;
        color: #555;
        max-width: 800px;
        margin: 0 auto;
      }
      .modal-content {
        transform: perspective(500px) rotateY(-10deg) translateZ(50px);
      }
      footer {
        background-color: #2c3e50;
        color: white;
        text-align: center;
        padding: 15px 0;
        position: relative;
        margin-top: 50px;
        border-top: 10px solid #34495e;
      }
      footer .container {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
      }
      footer h5 {
        font-size: 1.2em;
      }
      footer ul {
        list-style: none;
        padding: 0;
      }
      footer ul li {
        margin-bottom: 10px;
      }
      footer ul li a {
        color: white;
        text-decoration: none;
        transition: color 0.3s;
      }
      footer ul li a:hover {
        color: #f39c12;
      }
      .footer .social-icons {
        display: flex;
        gap: 10px;
      }
      .footer .social-icons a {
        color: #fff;
        font-size: 1.4rem;
        transition: color 0.3s;
      }
      .footer .social-icons a:hover {
        color: #f39c12;
      }
      footer p {
        font-size: 0.9em;
      }
      @media (max-width: 768px) {
        header {
          flex-direction: column;
          align-items: flex-start;
        }
        header nav ul {
          flex-direction: column;
          width: 100%;
          margin-top: 10px;
        }
        header nav ul li {
          margin: 5px 0;
        }
        .footer .container {
          flex-direction: column;
          align-items: center;
        }
        .footer .social-icons {
          margin-top: 10px;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="logo">
        <img src="/test/images/image.png" alt="Logo" />
      </div>
      <nav>
        <ul>
          <li>
            <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal"
              >Login</a
            >
          </li>
          <li>
            <a href="#" data-bs-toggle="modal" data-bs-target="#signupModal"
              >Sign Up</a
            >
          </li>
        </ul>
      </nav>
    </header>

    <section class="hero">
      <div class="hero-content">
        <h1>Welcome to Iron Pillar Engineering and Construction</h1>
        <p>Building the future with innovation and excellence.</p>
      </div>
    </section>

    <section class="about">
      <div class="container">
        <h2>About Iron Pillar Engineering and Construction</h2>
        <p>
          At Iron Pillar Engineering and Construction, we are dedicated to
          delivering top-notch construction solutions tailored to meet the
          unique needs of our clients. Our team of experts is committed to
          ensuring the highest standards of quality and excellence in every
          project we undertake.
        </p>
      </div>
    </section>

    <!-- Login Modal -->
    <div
      class="modal fade"
      id="loginModal"
      tabindex="-1"
      aria-labelledby="loginModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">Login</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="login-form">
              <div class="mb-3">
                <label for="login-email" class="form-label"
                  >Email address</label
                >
                <input
                  type="email"
                  class="form-control"
                  id="login-email"
                  required
                />
              </div>
              <div class="mb-3">
                <label for="login-password" class="form-label">Password</label>
                <input
                  type="password"
                  class="form-control"
                  id="login-password"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary">Login</button>
              <div
                id="login-error"
                class="text-danger mt-2"
                style="display: none"
              >
                Invalid email or password. Please try again.
              </div>
              <div
                id="login-success"
                class="text-success mt-2"
                style="display: none"
              >
                Login successful!
              </div>
              <div class="form-text mt-2">
                <a
                  href="#"
                  data-bs-toggle="modal"
                  data-bs-target="#forgotPasswordModal"
                  data-bs-dismiss="modal"
                  >Forgot Password?</a
                >
                |
                <a
                  href="#"
                  data-bs-toggle="modal"
                  data-bs-target="#signupModal"
                  data-bs-dismiss="modal"
                  >Create an account</a
                >
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Sign Up Modal -->
    <div
      class="modal fade"
      id="signupModal"
      tabindex="-1"
      aria-labelledby="signupModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="signupModalLabel">Sign Up</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="signup-form">
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="signup-firstname" class="form-label"
                    >First Name *</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="signup-firstname"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="signup-lastname" class="form-label"
                    >Last Name *</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="signup-lastname"
                    required
                  />
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="signup-email" class="form-label">Email *</label>
                  <input
                    type="email"
                    class="form-control"
                    id="signup-email"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="signup-confirm-email" class="form-label"
                    >Confirm Email *</label
                  >
                  <input
                    type="email"
                    class="form-control"
                    id="signup-confirm-email"
                    required
                  />
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="signup-password" class="form-label"
                    >Password *</label
                  >
                  <input
                    type="password"
                    class="form-control"
                    id="signup-password"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="signup-confirm-password" class="form-label"
                    >Confirm Password *</label
                  >
                  <input
                    type="password"
                    class="form-control"
                    id="signup-confirm-password"
                    required
                  />
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="signup-username" class="form-label"
                    >Username *</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="signup-username"
                    required
                  />
                </div>
                <div class="col-md-6">
                  <label for="signup-phone" class="form-label"
                    >Phone Number *</label
                  >
                  <input
                    type="tel"
                    class="form-control"
                    id="signup-phone"
                    required
                  />
                </div>
              </div>
              <div class="form-check mb-3">
                <input
                  type="checkbox"
                  class="form-check-input"
                  id="signup-terms"
                  required
                />
                <label class="form-check-label" for="signup-terms"
                  >I accept the <a href="#">Terms of Use</a> &
                  <a href="#">Privacy Policy</a></label
                >
              </div>
              <button type="submit" class="btn btn-primary">Sign Up</button>
              <div
                id="signup-error"
                class="text-danger mt-2"
                style="display: none"
              >
                Error signing up. Please try again.
              </div>
              <div
                id="signup-success"
                class="text-success mt-2"
                style="display: none"
              >
                Signup successful!
              </div>
              <div class="form-text mt-2">
                <a
                  href="#"
                  data-bs-toggle="modal"
                  data-bs-target="#loginModal"
                  data-bs-dismiss="modal"
                  >Already have an account? Login</a
                >
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Forgot Password Modal -->
    <div
      class="modal fade"
      id="forgotPasswordModal"
      tabindex="-1"
      aria-labelledby="forgotPasswordModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="forgotPasswordModalLabel">
              Forgot Password
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="forgot-password-form">
              <div class="mb-3">
                <label for="forgot-password-email" class="form-label"
                  >Email address</label
                >
                <input
                  type="email"
                  class="form-control"
                  id="forgot-password-email"
                  required
                />
              </div>
              <button type="submit" class="btn btn-primary">
                Reset Password
              </button>
              <div
                id="forgot-password-error"
                class="text-danger mt-2"
                style="display: none"
              >
                Error resetting password. Please try again.
              </div>
              <div
                id="forgot-password-success"
                class="text-success mt-2"
                style="display: none"
              >
                Password reset email sent!
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <h5>Quick Links</h5>
            <ul class="list-unstyled">
              <li><a href="#">Home</a></li>
              <li><a href="#">Projects</a></li>
              <li><a href="#">Services</a></li>
              <li><a href="#">Homes for Sale</a></li>
              <li><a href="#">About Us</a></li>
              <li><a href="#">Contact</a></li>
            </ul>
          </div>
          <div class="col-md-4">
            <h5>Contact Us</h5>
            <p>
              123 Engineering Way,<br />
              City, State, 12345<br />
              Email: info@ironpillar.com<br />
              Phone: (123) 456-7890
            </p>
          </div>
          <div class="col-md-4">
            <h5>Follow Us</h5>
            <div class="social-icons">
              <a href="#" class="text-white me-2"
                ><i class="fab fa-facebook-f"></i
              ></a>
              <a href="#" class="text-white me-2"
                ><i class="fab fa-twitter"></i
              ></a>
              <a href="#" class="text-white"
                ><i class="fab fa-instagram"></i
              ></a>
            </div>
          </div>
        </div>
        <p class="mt-3">
          &copy; 2024 Iron Pillar Engineering and Construction. All rights
          reserved.
        </p>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        document
          .getElementById("login-form")
          .addEventListener("submit", handleLoginFormSubmit);
        document
          .getElementById("signup-form")
          .addEventListener("submit", handleSignupFormSubmit);
        document
          .getElementById("forgot-password-form")
          .addEventListener("submit", handleForgotPasswordFormSubmit);
      });

      function handleLoginFormSubmit(event) {
        event.preventDefault();
        const email = event.target["login-email"].value;
        const password = event.target["login-password"].value;

        if (!email || !password) {
          alert("Please fill out all fields.");
          return;
        }

        fetch("/users/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
        })
          .then((response) => response.text())
          .then((data) => {
            try {
              const json = JSON.parse(data);
              if (json.error) {
                document.getElementById("login-error").style.display = "block";
                document.getElementById("login-success").style.display = "none";
              } else {
                document.getElementById("login-error").style.display = "none";
                document.getElementById("login-success").style.display =
                  "block";
                localStorage.setItem("user", JSON.stringify(json.user));
                setTimeout(() => {
                  window.location.href = "main.html";
                }, 2000);
              }
            } catch (error) {
              console.error("Error:", error);
              document.getElementById("login-error").innerText = data;
              document.getElementById("login-error").style.display = "block";
              document.getElementById("login-success").style.display = "none";
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            document.getElementById("login-error").innerText = error.message;
            document.getElementById("login-error").style.display = "block";
            document.getElementById("login-success").style.display = "none";
          });
      }

      function handleSignupFormSubmit(event) {
        event.preventDefault();
        const firstName = event.target["signup-firstname"].value;
        const lastName = event.target["signup-lastname"].value;
        const email = event.target["signup-email"].value;
        const confirmEmail = event.target["signup-confirm-email"].value;
        const password = event.target["signup-password"].value;
        const confirmPassword = event.target["signup-confirm-password"].value;
        const username = event.target["signup-username"].value;
        const phone = event.target["signup-phone"].value;

        if (
          !firstName ||
          !lastName ||
          !email ||
          !confirmEmail ||
          !password ||
          !confirmPassword ||
          !username ||
          !phone
        ) {
          alert("Please fill out all fields.");
          return;
        }

        if (email !== confirmEmail) {
          alert("Email and Confirm Email do not match.");
          return;
        }

        if (password !== confirmPassword) {
          alert("Password and Confirm Password do not match.");
          return;
        }

        fetch("/users", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            firstName,
            lastName,
            email,
            password,
            username,
            phoneNumber: phone,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.error) {
              document.getElementById("signup-error").style.display = "block";
              document.getElementById("signup-success").style.display = "none";
            } else {
              document.getElementById("signup-success").style.display = "block";
              document.getElementById("signup-error").style.display = "none";
              setTimeout(() => {
                var modal = bootstrap.Modal.getInstance(
                  document.getElementById("signupModal")
                );
                modal.hide();
              }, 2000);
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            document.getElementById("signup-error").innerText = error.message;
            document.getElementById("signup-error").style.display = "block";
            document.getElementById("signup-success").style.display = "none";
          });
      }

      function handleForgotPasswordFormSubmit(event) {
        event.preventDefault();
        const email = event.target["forgot-password-email"].value;

        if (!email) {
          alert("Please fill out the email field.");
          return;
        }

        fetch("/users/forgot-password", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.error) {
              document.getElementById("forgot-password-error").style.display =
                "block";
              document.getElementById("forgot-password-success").style.display =
                "none";
            } else {
              document.getElementById("forgot-password-success").style.display =
                "block";
              document.getElementById("forgot-password-error").style.display =
                "none";
              setTimeout(() => {
                var modal = bootstrap.Modal.getInstance(
                  document.getElementById("forgotPasswordModal")
                );
                modal.hide();
              }, 2000);
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            document.getElementById("forgot-password-error").innerText =
              error.message;
            document.getElementById("forgot-password-error").style.display =
              "block";
            document.getElementById("forgot-password-success").style.display =
              "none";
          });
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
