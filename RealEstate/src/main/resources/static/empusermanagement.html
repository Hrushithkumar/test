<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User and Employee Management System</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
          integrity="sha384-5e2ESR8Ycmos6g3gAKr1Jvwye8sW4U1u/cAKulfVJnkakCcMqhOudbtPnvJ+nbv7" crossorigin="anonymous">

    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link href="css/HeaderFooter.css" rel="stylesheet" />
    <script src="js/dynamicNavbar.js" defer></script>

    <style>
      body {
        font-family: "Montserrat", sans-serif;
        background-color: #f4f7f6;
        color: #333;
        margin: 0;
        padding-top: 80px;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }
      header {
        background-color: #2c3e50;
        padding: 10px 20px;
        position: fixed;
        width: 100%;
        top: 0;
        z-index: 1000;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      header .logo {
        display: flex;
        align-items: center;
        color: #fff;
        font-size: 1.5em;
        font-weight: bold;
      }
      header .logo img {
        max-width: 50px;
        height: auto;
        margin-right: 10px;
      }
      header nav ul {
        list-style: none;
        display: flex;
        margin: 0;
        padding: 0;
      }
      header nav ul li {
        margin: 0 15px;
        position: relative;
      }
      header nav ul li a {
        color: #fff;
        text-decoration: none;
        font-weight: bold;
        font-size: 1em;
        transition: color 0.3s;
      }
      header nav ul li a:hover {
        color: #f39c12;
      }
      header nav ul li ul {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background: #2c3e50;
        padding: 0;
        margin: 0;
        list-style: none;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      header nav ul li:hover ul {
        display: block;
      }
      header nav ul li ul li {
        margin: 0;
      }
      header nav ul li ul li a {
        padding: 10px 15px;
        display: block;
        color: #fff;
      }
      header nav ul li ul li a:hover {
        background: #34495e;
      }
      footer {
        background-color: #2c3e50;
        color: white;
        text-align: center;
        padding: 15px 0;
        position: relative;
        margin-top: auto;
        border-top: 10px solid #34495e;
      }
      footer.container {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
      }
      footer h5 {
        font-size: 1.2em;
      }
      footer ul {
        list-style: none;
        padding: 0;
      }
      footer ul li {
        margin-bottom: 10px;
      }
      footer ul li a {
        color: white;
        text-decoration: none;
        transition: color 0.3s;
      }
      footer ul li a:hover {
        color: #f39c12;
      }
      .footer .social-icons {
        display: flex;
        gap: 10px;
      }
      .footer .social-icons a {
        color: #fff;
        font-size: 1.4rem;
        transition: color 0.3s;
      }
      .footer .social-icons a:hover {
        color: #f39c12;
      }
      footer p {
        font-size: 0.9em;
      }
      .container .user {
        max-width: 1200px;
        margin: 20px auto;
        padding: 20px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      h2 {
        text-align: center;
        margin-bottom: 20px;
      }
      .form-group {
        margin-bottom: 15px;
      }
      .form-group label {
        font-weight: bold;
      }
      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
      }
      .form-group button {
        background-color: #4caf50;
        color: white;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 5px;
        transition: background-color 0.3s;
        display: block;
        width: 100%;
      }
      .form-group button:hover {
        background-color: #45a049;
      }
      .table {
        width: 100%;
        margin-bottom: 1rem;
        color: #212529;
      }
      .table th,
      .table td {
        padding: 0.75rem;
        vertical-align: top;
        border-top: 1px solid #dee2e6;
      }
      .table thead th {
        vertical-align: bottom;
        border-bottom: 2px solid #dee2e6;
      }
      .table tbody + tbody {
        border-top: 2px solid #dee2e6;
      }
      .table-sm th,
      .table-sm td {
        padding: 0.3rem;
      }
      .table-bordered {
        border: 1px solid #dee2e6;
      }
      .table-bordered th,
      .table-bordered td {
        border: 1px solid #dee2e6;
      }
      .table-bordered thead th,
      .table-bordered thead td {
        border-bottom-width: 2px;
      }
      .form-group.invalid input,
      .form-group.invalid textarea,
      .form-group.invalid select {
        border-color: red;
      }
      .form-group.invalid .error-message {
        color: red;
        font-size: 0.9em;
        display: block;
      }
      @media (max-width: 768px) {
        header {
          flex-direction: column;
          align-items: flex-start;
        }
        header nav ul {
          flex-direction: column;
          width: 100%;
          margin-top: 10px;
        }
        header nav ul li {
          margin: 5px 0;
        }
        .footer .container {
          flex-direction: column;
          align-items: center;
        }
        .footer .social-icons {
          margin-top: 10px;
        }

        .message {
          display: none; /* Initially hidden */
          padding: 10px;
          margin: 10px 0;
          border-radius: 5px;
          font-size: 16px;
          text-align: center;
        }

        .success {
          background-color: #d4edda;
          color: #155724;
          border: 1px solid #c3e6cb;
        }

        .error {
          background-color: #f8d7da;
          color: #721c24;
          border: 1px solid #f5c6cb;
        }
      }

      @media print {
        body * {
          visibility: hidden;
        }
        .print-container,
        .print-container * {
          visibility: visible;
        }
        .print-container {
          position: absolute;
          left: 0;
          top: 0;
        }
      }
    </style>
    <script src="js/auth.js"></script>
  </head>
  <body>
    <div id="header-container"></div>


  <section class="container user mt-5">
      <h2>User Management System</h2>
    <div id="alert-placeholder"></div>
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="users-tab"
            data-bs-toggle="tab"
            data-bs-target="#users"
            type="button"
            role="tab"
            aria-controls="users"
            aria-selected="true"
          >
            Users
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="create-user-tab"
            data-bs-toggle="tab"
            data-bs-target="#create-user"
            type="button"
            role="tab"
            aria-controls="create-user"
            aria-selected="false"
          >
            Create User
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="delete-user-tab"
            data-bs-toggle="tab"
            data-bs-target="#delete-user"
            type="button"
            role="tab"
            aria-controls="delete-user"
            aria-selected="false"
          >
            Delete User
          </button>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div
          class="tab-pane fade show active"
          id="users"
          role="tabpanel"
          aria-labelledby="users-tab"
        >
          <div class="mb-3 mt-3">
            <input
              type="text"
              id="searchInput"
              class="form-control"
              placeholder="Search users by name"
            />
          </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Email</th>
                <th>Phone Number</th>
                <th>Created On</th>
                <th>Updated On</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="userTableBody">
              <!-- User rows will be dynamically added here -->
            </tbody>
          </table>
        </div>
        <div
          class="tab-pane fade"
          id="create-user"
          role="tabpanel"
          aria-labelledby="create-user-tab"
        >
          <form id="userForm" class="mt-3" novalidate>
            <input type="hidden" id="userId" />
            <div class="form-group">
              <label for="username">Username:</label>
              <input
                type="text"
                id="username"
                name="username"
                required
                aria-required="true"
                aria-describedby="username-error"
              />
              <span class="error-message" id="username-error"></span>
            </div>
            <div class="form-group">
              <label for="firstName">First Name:</label>
              <input
                      type="text"
                      id="firstName"
                      name="firstName"
                      required
                      aria-required="true"
                      aria-describedby="firstname-error"
              />
              <span class="error-message" id="firstname-error"></span>
            </div>
            <div class="form-group">
              <label for="lastName">Last Name:</label>
              <input
                      type="text"
                      id="lastName"
                      name="lastName"
                      required
                      aria-required="true"
                      aria-describedby="lastName-error"
              />
              <span class="error-message" id="lastName-error"></span>
            </div>
            <div class="form-group">
              <label for="email">Email:</label>
              <input
                type="email"
                id="email"
                name="email"
                required
                aria-required="true"
                aria-describedby="email-error"
              />
              <span class="error-message" id="email-error"></span>
            </div>
            <div class="form-group">
              <label for="phoneNumber">Phone Number:</label>
              <input
                type="tel"
                id="phoneNumber"
                name="phoneNumber"
                required
                aria-required="true"
                aria-describedby="phoneNumber-error"
              />
              <span class="error-message" id="phoneNumber-error"></span>
            </div>
            <div class="form-group">
              <label for="password">Password:</label>
              <input
                type="password"
                id="password"
                name="password"
                required
                aria-required="true"
                aria-describedby="password-error"
              />
              <span class="error-message" id="password-error"></span>
            </div>

            <div id="message" class="message"></div>

            <div class="form-group">
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
        <div
          class="tab-pane fade"
          id="delete-user"
          role="tabpanel"
          aria-labelledby="delete-user-tab"
        >
          <div class="mb-3 mt-3">
            <input
              type="text"
              id="searchDeleteInput"
              class="form-control"
              placeholder="Search users by name to delete"
            />
          </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Email</th>
                <th>Phone Number</th>
                <th>Created On</th>
                <th>Updated On</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="deleteUserTableBody">
              <!-- User rows will be dynamically added here -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section class="container user mt-5 print-container">
      <h2>Employee Management System</h2>
      <div id="alert-employee-placeholder"></div>
      <button class="btn btn-secondary mb-3" onclick="window.print()">
        Print
      </button>
      <ul class="nav nav-tabs" id="employeeTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button
            class="nav-link active"
            id="employees-tab"
            data-bs-toggle="tab"
            data-bs-target="#employees"
            type="button"
            role="tab"
            aria-controls="employees"
            aria-selected="true"
          >
            Employees
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="create-employee-tab"
            data-bs-toggle="tab"
            data-bs-target="#create-employee"
            type="button"
            role="tab"
            aria-controls="create-employee"
            aria-selected="false"
          >
            Create Employee
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button
            class="nav-link"
            id="delete-employee-tab"
            data-bs-toggle="tab"
            data-bs-target="#delete-employee"
            type="button"
            role="tab"
            aria-controls="delete-employee"
            aria-selected="false"
          >
            Delete Employee
          </button>
        </li>
      </ul>
      <div class="tab-content" id="employeeTabContent">
        <div
          class="tab-pane fade show active"
          id="employees"
          role="tabpanel"
          aria-labelledby="employees-tab"
        >
          <div class="mb-3 mt-3">
            <input
              type="text"
              id="searchEmployeeInput"
              class="form-control"
              placeholder="Search employees by name"
            />
          </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>Employee ID</th>
                <th>Employee Username</th>
                <th>Employee Email</th>
                <th>Employee Phone Number</th>
                <th>Created On</th>
                <th>Updated On</th>
                <th>Job Title</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="employeeTableBody">
              <!-- Employee rows will be dynamically added here -->
            </tbody>
          </table>
        </div>
        <div
          class="tab-pane fade"
          id="create-employee"
          role="tabpanel"
          aria-labelledby="create-employee-tab"
        >
          <form id="employeeForm" class="mt-3" novalidate>
            <input type="hidden" id="employeeId" />
            <div class="form-group">
              <label for="employeeUsername">Username:</label>
              <input
                type="text"
                id="employeeUsername"
                name="username"
                required
                aria-required="true"
                aria-describedby="employee-username-error"
              />
              <span class="error-message" id="employee-username-error"></span>
            </div>
            <div class="form-group">
              <label for="employeeFirstName">First Name:</label>
              <input
                      type="text"
                      id="employeeFirstName"
                      name="firstName"
                      required
                      aria-required="true"
                      aria-describedby="firstname-error"
              />
              <span class="error-message" id="employee-firstname-error"></span>
            </div>
            <div class="form-group">
              <label for="employeeLastName">Last Name:</label>
              <input
                      type="text"
                      id="employeeLastName"
                      name="lastName"
                      required
                      aria-required="true"
                      aria-describedby="lastName-error"
              />
              <span class="error-message" id="employee-lastName-error"></span>
            </div>

            <div class="form-group">
              <label for="employeeEmail">Email:</label>
              <input
                type="email"
                id="employeeEmail"
                name="email"
                required
                aria-required="true"
                aria-describedby="employee-email-error"
              />
              <span class="error-message" id="employee-email-error"></span>
            </div>
            <div class="form-group">
              <label for="employeePhoneNumber">Phone Number:</label>
              <input
                type="tel"
                id="employeePhoneNumber"
                name="phoneNumber"
                required
                aria-required="true"
                aria-describedby="employee-phoneNumber-error"
              />
              <span
                class="error-message"
                id="employee-phoneNumber-error"
              ></span>
            </div>
            <div class="form-group">
              <label for="employeeJobTitle">Job Title:</label>
              <input
                      type="text"
                      id="employeeJobTitle"
                      name="jobTitle"
                      required
                      aria-required="true"
                      aria-describedby="employee-jobTitle-error"
              />
              <span
                      class="error-message"
                      id="employee-jobTitle-error"
              ></span>
            </div>
            <div class="form-group">
              <label for="employeePassword">Password:</label>
              <input
                type="password"
                id="employeePassword"
                name="password"
                required
                aria-required="true"
                aria-describedby="employee-password-error"
              />
              <span class="error-message" id="employee-password-error"></span>
            </div>

            <div id="employee message" class="message"></div>

            <div class="form-group">
              <button type="submit" class="btn btn-primary">Submit</button>
            </div>
          </form>
        </div>
        <div
          class="tab-pane fade"
          id="delete-employee"
          role="tabpanel"
          aria-labelledby="delete-employee-tab"
        >
          <div class="mb-3 mt-3">
            <input
              type="text"
              id="searchDeleteEmployeeInput"
              class="form-control"
              placeholder="Search employees by name to delete"
            />
          </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>Employee ID</th>
                <th>Employee Username</th>
                <th>Employee Email</th>
                <th>Employee Phone Number</th>
                <th>Created On</th>
                <th>Updated On</th>
                <th>Job Title</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="deleteEmployeeTableBody">
              <!-- Employee rows will be dynamically added here -->
            </tbody>
          </table>
        </div>
      </div>
    </section>

  <div id="footer-container"></div>
    <script>

      fetch('/includes/header.html')
              .then(response => response.text())
              .then(html => {
                document.getElementById('header-container').innerHTML = html;
              })
              .catch(error => console.error('Error fetching header:', error));

      fetch('Footer.html')
              .then(response => response.text())
              .then(html => {
                document.getElementById('footer-container').innerHTML = html;
              })
              .catch(error => console.error('Error fetching footer:', error));


      const adminApiBaseURL = "/admin";
      const userApiBaseURL = "/users";
      const employeeApiBaseURL = "/employees";

      document.addEventListener("DOMContentLoaded", () => {
        fetchUsers();
        fetchEmployees();
        document
          .getElementById("userForm")
          .addEventListener("submit", handleFormSubmit);
        document
          .getElementById("employeeForm")
          .addEventListener("submit", handleEmployeeFormSubmit);
        document
          .getElementById("searchInput")
          .addEventListener("input", handleSearch);
        document
          .getElementById("searchDeleteInput")
          .addEventListener("input", handleSearchDelete);
        document
          .getElementById("searchEmployeeInput")
          .addEventListener("input", handleEmployeeSearch);
        document
          .getElementById("searchDeleteEmployeeInput")
          .addEventListener("input", handleEmployeeSearchDelete);
      });

      function fetchUsers(query = "") {
        var modifiedQuery;
        if (query !== "") {
          modifiedQuery = `users/search?username=${query}`;
        } else {
          modifiedQuery = `${userApiBaseURL}`;
        }

        fetchWithAuth(modifiedQuery)
          .then((response) => response.json())
          .then((users) => {
            const userTableBody = document.getElementById("userTableBody");
            const deleteUserTableBody = document.getElementById(
              "deleteUserTableBody"
            );
            userTableBody.innerHTML = "";
            deleteUserTableBody.innerHTML = "";
            users.forEach((user) => {
              const userRow = createUserRow(user);
              userTableBody.appendChild(userRow);
              deleteUserTableBody.appendChild(userRow.cloneNode(true));
            });
          })
          .catch((error) => console.error("Error fetching users:", error));
      }

      function createUserRow(user) {
        const row = document.createElement("tr");
        row.innerHTML = `
        <td>${user.id}</td>
        <td>${user.username}</td>
        <td>${user.email}</td>
        <td>${user.phoneNumber}</td>
        <th>${user.createdAt}</th>
        <th>${user.updatedAt}</th>
        <td>
          <button class="btn btn-warning btn-sm m-2" onclick="editUser(${user.id})">Update</button>
          <button class="btn btn-danger btn-sm" onclick="deleteUser(${user.id})">Delete</button>
        </td>
      `;
        return row;
      }

      function handleFormSubmit(event) {
        event.preventDefault();
        const form = event.target;
        const userId = document.getElementById("userId").value;
        const url = userId ? `${adminApiBaseURL}/user/${userId}` : "/register";
        const method = userId ? "PUT" : "POST";
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());
        if (method === "POST") {
          data.password = formData.get("password");
        }

        fetch(url, {
          method: method,
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data),
        })
        .then((response) => response.json())
        .then((data) => {
          //const messageDiv = document.getElementById("message");
          const alertPlaceholder = document.getElementById("alert-placeholder");
          if (data.error) {
            // messageDiv.className = "message error";
            // messageDiv.textContent = data.error;
            alertPlaceholder.innerHTML = `
                <div class="alert alert-danger" role="alert">
                    ${data.error}
                </div>
            `;
          } else {
             fetchUsers();
            // form.reset();
            document.getElementById("userId").value = "";
            // messageDiv.className = "message success";
            // messageDiv.textContent = "User created successfully ";
              alertPlaceholder.innerHTML = `
                <div class="alert alert-success" role="alert">
                    User created successfully
                </div>
            `;
            event.target.reset();
          }
          //messageDiv.style.display = "block";
         setTimeout(() => {
           //messageDiv.style.display = "none";
           alertPlaceholder.innerHTML = "";
         }, 8000); // Hide message after 5 seconds

        })
        .catch((error) => {
          // const messageDiv = document.getElementById("message");
          // messageDiv.className = "message error";
          // messageDiv.textContent = "An unexpected error occurred: " + error.message;
          // messageDiv.style.display = "block";
          const alertPlaceholder = document.getElementById("alert-placeholder");
          alertPlaceholder.innerHTML = `
            <div class="alert alert-danger" role="alert">
                An unexpected error occurred: ${error.message}
            </div>
        `;
          setTimeout(() => {
          // messageDiv.style.display = "none";
            alertPlaceholder.innerHTML = "";
          }, 8000); // Hide message after 3 seconds
        });
      }


      function editUser(userId) {
        fetchWithAuth(`${userApiBaseURL}/${userId}`)
          .then((response) => response.json())
          .then((user) => {
            document.getElementById("userId").value = user.id;
            document.getElementById("username").value = user.username;
            document.getElementById("email").value = user.email;
            document.getElementById("phoneNumber").value = user.phoneNumber;
            document.getElementById("password").value = user.password;
            document.getElementById("firstName").value = user.firstName;
            document.getElementById("lastName").value = user.lastName;
            document.getElementById("create-user-tab").click();
          })
          .catch((error) => console.error("Error fetching user:", error));
      }

      function deleteUser(userId) {
        if (confirm("Are you sure you want to delete this user?")) {
          fetchWithAuth(`${adminApiBaseURL}/user/${userId}`, {
            method: "DELETE"
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error("Network response was not ok");
              }
              fetchUsers();
              alert("User deleted successfully!");
            })
            .catch((error) => console.error("Error deleting user:", error));
        }
      }

      function handleSearch(event) {
        const query = event.target.value.trim();
        fetchUsers(query);
      }

      function handleSearchDelete(event) {
        const query = event.target.value;
        fetchUsers(query);
      }

      // Logic for CRUD Employees

      function fetchEmployees(query = "") {
        var modifiedQuery;
        if (query !== "") {
          modifiedQuery = `employees/search?username=${query}`;
        } else {
          modifiedQuery = `${employeeApiBaseURL}`;
        }
        fetchWithAuth(modifiedQuery)
          .then((response) => response.json())
          .then((employees) => {
            const employeeTableBody =
              document.getElementById("employeeTableBody");
            const deleteEmployeeTableBody = document.getElementById(
              "deleteEmployeeTableBody"
            );
            employeeTableBody.innerHTML = "";
            deleteEmployeeTableBody.innerHTML = "";
            employees.forEach((employee) => {
              const employeeRow = createEmployeeRow(employee);
              employeeTableBody.appendChild(employeeRow);
              deleteEmployeeTableBody.appendChild(employeeRow.cloneNode(true));
            });
          })
          .catch((error) => console.error("Error fetching employees:", error));
      }

      function createEmployeeRow(employee) {
        const row = document.createElement("tr");
        row.innerHTML = `
        <td>${employee.id}</td>
        <td>${employee.username}</td>
        <td>${employee.email}</td>
        <td>${employee.phoneNumber}</td>
        <th>${employee.createdAt}</th>
        <th>${employee.updatedAt}</th>
        <td>${employee.jobTitle}</td>
        <td>
          <button class="btn btn-warning btn-sm" onclick="editEmployee(${employee.id})">Edit</button>
          <button class="btn btn-danger btn-sm" onclick="deleteEmployee(${employee.id})">Delete</button>
        </td>
      `;
        return row;
      }

      function handleEmployeeFormSubmit(event) {
        event.preventDefault();

        // Get form values
        const firstName = event.target["employeeFirstName"].value;
        const lastName = event.target["employeeLastName"].value;
        const email = event.target["employeeEmail"].value;
        const password = event.target["employeePassword"].value;
        const username = event.target["employeeUsername"].value;
        const phone = event.target["employeePhoneNumber"].value;
        const jobTitle = event.target["employeeJobTitle"].value;
        const employeeId = document.getElementById("employeeId").value;

        // Validate form fields
        if (!firstName || !lastName || !email || !password || !username || !phone || ! jobTitle) {
          alert("Please fill out all fields.");
          return;
        }

        // Determine URL and method based on whether we're creating or updating
        const url = employeeId ? `${adminApiBaseURL}/employee/${employeeId}` : `${adminApiBaseURL}/employee/register`;
        const method = employeeId ? "PUT" : "POST";

        // Prepare data object
        const data = {
          firstName,
          lastName,
          email,
          password,
          username,
          jobTitle,
          phoneNumber: phone
        };

        // Perform the fetch request
        fetch(url, {
          method: method,
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((response) => response.json())
          .then((data) => {
            const alertPlaceholder = document.getElementById("alert-employee-placeholder");
            if (data.error) {
              // messageDiv.className = "employeeMessage error";
              // messageDiv.textContent = data.error;
              alertPlaceholder.innerHTML = `
                <div class="alert alert-danger" role="alert">
                    ${data.error}
                </div>
            `;
            } else {
              fetchEmployees();
              document.getElementById("employeeId").value = "";
              // messageDiv.className = "employeeMessage success";
              // messageDiv.textContent = "Employee created successfully ";
              alertPlaceholder.innerHTML = `
                <div class="alert alert-success" role="alert">
                    Employee created successfully
                </div>
            `;
              event.target.reset();
            }
            //messageDiv.style.display = "block";
            setTimeout(() => {
              alertPlaceholder.innerHTML = "";
              //messageDiv.style.display = "none";
            }, 5000); // Hide message after 5 seconds

          })
          .catch((error) => {
            const alertPlaceholder = document.getElementById("alert-employee-placeholder");
            alertPlaceholder.innerHTML = `
            <div class="alert alert-danger" role="alert">
                An unexpected error occurred: ${error.message}
            </div>
        `;
            // const messageDiv = document.getElementById("employeeMessage");
            // messageDiv.className = "employeeMessage error";
            // messageDiv.textContent = "An unexpected error occurred: " + error.message;
            // messageDiv.style.display = "block";
            setTimeout(() => {
              //messageDiv.style.display = "none";
              alertPlaceholder.innerHTML = ""
            }, 8000); // Hide message after 8 seconds
          });
      }

      function editEmployee(employeeId) {
        fetchWithAuth(`${employeeApiBaseURL}/${employeeId}`)
                .then((response) => response.json())
                .then((employee) => {
                  document.getElementById("employeeId").value = employee.id;
                  document.getElementById("employeeUsername").value = employee.username;
                  document.getElementById("employeeEmail").value = employee.email;
                  document.getElementById("employeeFirstName").value = employee.firstName;
                  document.getElementById("employeeLastName").value = employee.lastName;
                  document.getElementById("employeePhoneNumber").value = employee.phoneNumber;
                  document.getElementById("employeeJobTitle").value = employee.jobTitle;
                  document.getElementById("employeePassword").value = employee.password;

                  const messageDiv = document.getElementById("employeeMessage");
                  messageDiv.style.display = "none";
                  messageDiv.textContent = "";

                })
                .catch((error) => console.error("Error fetching employee:", error));
      }

      function deleteEmployee(employeeId) {
        if (confirm("Are you sure you want to delete this employee?")) {
          fetch(`${adminApiBaseURL}${employeeApiBaseURL}/${employeeId}`, {
            method: "DELETE",
          })
            .then((response) => {
              if (!response.ok) {
                throw new Error("Network response was not ok");
              }
              fetchEmployees();
              alert("Employee deleted successfully!");
            })
            .catch((error) => console.error("Error deleting employee:", error));
        }
      }

      function handleEmployeeSearch(event) {
        const query = event.target.value;
        fetchEmployees(query);
      }

      function handleEmployeeSearchDelete(event) {
        const query = event.target.value;
        fetchEmployees(query);
      }

    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>s
  </body>
</html>
